package utils;import com.aventstack.extentreports.ExtentReports;import com.aventstack.extentreports.ExtentTest;import com.aventstack.extentreports.reporter.ExtentSparkReporter;import com.aventstack.extentreports.reporter.configuration.Theme;import java.text.SimpleDateFormat;import java.util.Date;public class ExtentManager {    private static ExtentReports extent;    private static ThreadLocal<ExtentTest> test = new ThreadLocal<>();    //ThreadLocal<ExtentTest> 容器，存储当前线程的用例报告节点（ExtentTest），保证多线程并行执行用例时，日志 / 截图不会错乱（每个线程独立持有自己的 ExtentTest）。    private static String getReportFileName() {        // 定义时间格式（年月日_时分秒，确保唯一）        SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd_HHmmss");        String timestamp = sdf.format(new Date()); // 生成当前时间戳（如 20251113_153022）        // 拼接文件名：前缀 + 时间戳 + 后缀        return "reports/ExtentReport_" + timestamp + ".html";    }    public static void initReport() {        if (extent == null) { //// 单例校验：只初始化一次            ExtentSparkReporter spark = new ExtentSparkReporter(getReportFileName());            // 配置 HTML 报告样式：浏览器标题、报告名称、主题（浅色）            spark.config().setDocumentTitle("Automation Test Report");            spark.config().setReportName("Execution Report");            spark.config().setTheme(Theme.STANDARD);            extent = new ExtentReports();  // 创建报告核心实例            extent.attachReporter(spark); // 绑定 HTML 报告生成器（生成 .html 文件）            extent.setSystemInfo("Environment", "QA");  // 添加系统信息（报告中显示：环境、测试人员）            extent.setSystemInfo("Tester", "Xiaohong");        }    }    //对外提供 extent 实例（比如特殊场景下需要手动操作 ExtentReports 时使用, 但是下面有createTest的方法, 所以这个很少用    public static ExtentReports getExtent() {        return extent;    }    //所有用例执行完毕后（如 @AfterSuite）调用，将用例状态、日志、截图等数据写入 HTML 报告，否则报告为空。    public static void flushReport() {        if (extent != null) {            extent.flush();        }    }    public static ExtentTest createTest(String name) {        ExtentTest extentTest = extent.createTest(name);   // 1. 创建用例报告节点        test.set(extentTest);  // 2. 绑定到当前线程（ThreadLocal）        return extentTest; // 3. 返回创建的 ExtentTest 对象（可选外部使用）    }    public static ExtentTest getTest() {        return test.get(); // 从当前线程的 ThreadLocal 中获取 ExtentTest    }}